
# 🕵️‍♂️ June 2025 Threat Hunt: *"Deep Access – The Adversary"*

> *"Not all breaches sound alarms. Some whisper their presence, slipping through telemetry and leaving behind only the faintest trace. Our job: amplify the signal."*

In June 2025, a coordinated threat hunt was conducted across simulated enterprise environments to investigate stealthy adversarial behaviors that mimic advanced persistent threat (APT) tactics. The scenario focused on tracking malicious actions across two virtual machines, designed to replicate real-world intrusion patterns: covert PowerShell usage, registry manipulation, scheduled task abuse, and lateral movement — all executed without triggering traditional alerts.

The adversary’s playbook was methodical: from initial PowerShell-based execution on a short-lived system to persistence via registry keys and scheduled tasks, culminating in credential dumping, internal reconnaissance, and data staging for exfiltration. Each technique was a breadcrumb — and our task was to follow them all.

This report includes:

- 📅 Timeline reconstruction of adversarial activity across **`acolyte756`** and **`victor-disa-vm`**
- 📜 Detailed queries using Microsoft 365 Defender Advanced Hunting (KQL)
- 🧠 MITRE ATT&CK mapping to understand TTP alignment
- 💠 Diamond Model analysis for adversary profiling
- 🧪 Evidence-based summaries supporting each flag and behavior discovered


---

## 🧰 Platforms and Tools

**Analysis Environment:**
- Microsoft Defender for Endpoint
- Log Analytics Workspace

**Techniques Used:**
- Kusto Query Language (KQL)
- Behavioral analysis of endpoint logs (DeviceProcessEvents, DeviceNetworkEvents, DeviceRegistryEvents)

---

## 🔍 Summary of Findings (Flags)

| Flag | Objective Description | Finding |
|------|------------------------|---------|
| 1 | Initial infection vector (low event volume device) | `acolyte756` was the first targeted machine |
| 2 | First suspicious PowerShell activity | Timestamp: `2025-05-24T00:02:00Z` |
| 3 | Unusual outbound communication | RemoteURL: `eoqsu1hq6e9ulga.m.pipedream.net` |
| 4 | Scheduled task creation | TaskName: `SimC2Task` created via `schtasks.exe` |
| 5 | Registry persistence | Registry Key: `HKLM\...\TaskCache\Tree\SimC2Task` |
| 6 | Encoded PowerShell | `powershell.exe -EncodedCommand ...` |
| 7 | PowerShell downgrade attempt | `powershell.exe -Version 2 -ExecutionPolicy Bypass` |
| 8 | Lateral movement | Next device: `victor-disa-vm` |
| 9 | Lateral artifact | File: `savepoint_sync.ps1` |
| 10 | Persistence on second machine | Registry value referencing: `savepoint_sync.ps1` |
| 11 | C2 from second machine | RemoteURL: `eo1v1texxlrdq3v.m.pipedream.net` |
| 12 | WMI-based execution | Script: `beacon_sync_job_flag2.ps1` |
| 13 | Credential theft attempt | File: `mimidump_sim.txt` |
| 14 | Document exfil target | File: `RolloutPlan_v8_477.docx` |
| 15 | Staging payloads | Archive: `spicycore_loader_flag8.zip` |
| 16 | Task execution | Task created via `schtasks.exe` on `victor` |

---

## 🧠 MITRE ATT&CK Mapping

| Tactic | Technique | ID | Description |
|--------|-----------|----|-------------|
| Initial Access | Phishing: Spearphishing Attachment | T1566.001 | PowerShell launched via phishing document |
| Execution | Command and Scripting Interpreter: PowerShell | T1059.001 | Used for encoded and direct execution |
| Persistence | Registry Run Keys / Startup Folder | T1547.001 | HKCU\Run and HKLM\TaskCache used |
| Persistence | Scheduled Task/Job | T1053.005 | SimC2Task and SpicyPayloadSync created |
| Defense Evasion | Obfuscated Files or Information | T1027 | Base64-encoded PowerShell |
| Credential Access | OS Credential Dumping | T1003 | Mimikatz-sim file deployed |
| Discovery | System Information Discovery | T1082 | PowerShell enumeration |
| Lateral Movement | Remote Services: SMB/Script | T1021.002 | Movement from acolyte to victor |
| Collection | Data Staged | T1074 | Archive dropped in Public directory |
| Exfiltration | Exfiltration Over C2 Channel | T1041 | Beaconing to pipedream endpoint |

---

## 💠 Diamond Model of Intrusion Analysis

| Category | Entity |
|---------|--------|
| **Adversary** | Simulated APT group leveraging LOLBins and obfuscation |
| **Capability** | Encoded PowerShell, Scheduled Tasks, Credential Dumping |
| **Infrastructure** | `*.pipedream.net` (C2 channel) |
| **Victim** | `acolyte756`, `victor-disa-vm` (Windows VMs in Southeast Asia region) |

---

## 📂 Supporting KQL Queries

> Full KQL query set used for each stage is available [upon request or in attached GitHub repository].

---

**Report Generated By:** Steven Cruz  
**Status:** ✅ Complete – 16 flags validated and contextualized  

**GitHub Ready:** ✔️

